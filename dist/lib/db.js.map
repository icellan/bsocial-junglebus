{"version":3,"file":"db.js","names":["db","getDB","mongodbConnectionUrl","client","connect","MongoClient","mongoUrl","useNewUrlParser","useUnifiedTopology","keepAlive","catch","err","console","log","process","exit","dbName"],"sources":["../../src/lib/db.js"],"sourcesContent":["import connect from 'mongodb';\nimport { dbName, mongoUrl } from '../config';\n\nlet db = null;\n\n/**\n * Database singleton\n *\n * @returns {Promise<null|Db>}\n */\nexport const getDB = async function (mongodbConnectionUrl = false) {\n  if (!db) {\n    const client = new connect.MongoClient(mongodbConnectionUrl || mongoUrl, {\n      useNewUrlParser: true,\n      useUnifiedTopology: true,\n      keepAlive: 1,\n    });\n\n    await client.connect()\n      .catch((err) => {\n        console.log(err);\n        process.exit(-1);\n      });\n\n    db = client.db(dbName);\n  }\n\n  return db;\n};\n"],"mappings":"+VAGIA,EAAE,CAAG,IAAI,CAOAC,KAAK,iDAAG,WAA8C,IAA9BC,EAAoB,6DACvD,GAAI,CAACF,EAAE,CAAE,CACP,GAAMG,EAAM,CAAG,GAAIC,iBAAO,CAACC,WAAW,CAACH,CAAoB,EAAII,gBAAQ,CAAE,CACvEC,eAAe,GAAM,CACrBC,kBAAkB,GAAM,CACxBC,SAAS,CAAE,CACb,CAAC,CAAC,CAAC,KAEGN,EAAM,CAACC,OAAO,EAAE,CACnBM,KAAK,CAAEC,CAAG,EAAK,CACdC,OAAO,CAACC,GAAG,CAACF,CAAG,CAAC,CAChBG,OAAO,CAACC,IAAI,CAAC,CAAC,CAAC,CACjB,CAAC,CAAC,CAEJf,EAAE,CAAGG,CAAM,CAACH,EAAE,CAACgB,cAAM,CACvB,CAEA,MAAOhB,GACT,CAAC"}